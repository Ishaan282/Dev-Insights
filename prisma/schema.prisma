// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id          String   @id @default(cuid())
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt
    imageUrl   String?
    firstName   String?
    lastName    String?

    emailAddress String  @unique

    credits     Int      @default(450) //default credits for how any files allowed in a repo

    userToProjects UserToProject[]
}

model Project {
    id              String @id @default(cuid())
    createdAt       DateTime @default(now())
    updatedAt       DateTime @updatedAt

    name            String
    githubUrl       String

    deletedAt       DateTime?

    userToProjects  UserToProject[]
    commits         Commit[]
}


// creating many to many relation for users and projects 
model UserToProject{
    id          String @id @default(cuid())
    createdAt   DateTime @default(now())
    updatedAt   DateTime @updatedAt

    userId      String
    projectId   String

    user        User @relation(fields: [userId], references: [id])
    project     Project @relation(fields: [projectId], references: [id])

    @@unique([userId, projectId])
}

//model to store commits 
model Commit{
    id                  String @id @default(cuid())
    createdAt           DateTime @default(now())
    updatedAt           DateTime @updatedAt

    projectId           String
    project             Project @relation(fields: [projectId], references: [id])

    commitMessage       String
    commitHash          String
    commitAuthorName    String
    commitAutherAvatar  String
    commitDate          DateTime

    //ai summary
    summary             String
}